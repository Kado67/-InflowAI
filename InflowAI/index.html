<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inflow Market</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body class="page-root">

  <!-- ============================== -->
  <!--          HEADER                -->
  <!-- ============================== -->
  <header class="main-header">
    <div class="logo">Inflow<span>Market</span></div>

    <div class="search">
      <input type="text" id="searchInput" placeholder="ÃœrÃ¼n ara..." />
      <span class="search-icon">ğŸ”</span>
    </div>

    <div class="header-right">
      <a href="hesabim.html" class="header-icon-btn">
        <span>ğŸ‘¤</span> HesabÄ±m
      </a>
      <a href="sepet.html" class="header-icon-btn">
        <span>ğŸ›’</span> Sepet
      </a>
    </div>
  </header>

  <!-- ============================== -->
  <!--        KATEGORÄ° BAR            -->
  <!-- ============================== -->
  <div class="category-strip">
    <div class="category-pill active">TÃ¼mÃ¼</div>
    <div class="category-pill">Elektronik</div>
    <div class="category-pill">Moda</div>
    <div class="category-pill">Ev & YaÅŸam</div>
    <div class="category-pill">Saat & TakÄ±</div>
    <div class="category-pill">Market</div>
    <div class="category-pill">Spor</div>
  </div>

  <!-- ============================== -->
  <!--          ANA Ä°Ã‡ERÄ°K            -->
  <!-- ============================== -->
  <main class="page-main">
    <div id="productGrid" class="product-grid">YÃ¼kleniyor...</div>
  </main>

  <!-- ============================== -->
  <!--             TABBAR            -->
  <!-- ============================== -->
  <nav class="app-tabbar">
    <a href="index.html" class="active"><span>ğŸ </span>Anasayfa</a>
    <a href="sepet.html"><span>ğŸ›’</span>Sepet</a>
    <a href="hesabim.html"><span>ğŸ‘¤</span>HesabÄ±m</a>
  </nav>

  <script>
    const API = "https://inflowai-api.onrender.com/api";

    async function loadProducts() {
      const grid = document.getElementById("productGrid");
      grid.innerHTML = "YÃ¼kleniyor...";

      const res = await fetch(API + "/products");
      const data = await res.json();

      if (!res.ok) {
        grid.innerHTML = "ÃœrÃ¼nler yÃ¼klenemedi.";
        return;
      }

      grid.innerHTML = "";

      data.products.forEach(p => {
        grid.innerHTML += `
          <div class="product-card">
            <img src="${p.images?.[0] || ''}" alt="">
            <div class="product-card-body">
              <div class="product-name">${p.name}</div>
              <div class="product-price">${p.price}â‚º</div>
              <button class="btn primary add-to-cart-mini" onclick="addToCart('${p._id}')">
                Sepete Ekle
              </button>
            </div>
          </div>
        `;
      });
    }

    async function addToCart(id) {
      const token = localStorage.getItem("token");
      if (!token) {
        window.location.href = "hesabim.html";
        return;
      }

      await fetch(API + "/cart/add", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer " + token
        },
        body: JSON.stringify({ productId: id, quantity: 1 })
      });

      alert("Sepete eklendi!");
    }

    loadProducts();
  </script>

</body>
</html>
